{"id":524775698,"lang":"cpp","time":"5 months, 1 week","timestamp":1626670219,"status_display":"Accepted","runtime":"936 ms","url":"/submissions/detail/524775698/","is_pending":"Not Pending","title":"Maximum Genetic Difference Query","memory":"400.8 MB","code":"struct XOR_binary_trie{\n    // Trie implementation of maximum xor query in a list of values\n    struct node{\n        node* next[2];\n        int cnt = 0;\n    };\n    node *R;\n    XOR_binary_trie(){\n        R = new node();\n    }\n    int MAX_BIT = 18;\n    void add(int x,int count = 1){\n        node* root = R;\n        for(int i = MAX_BIT;i>=0;i--){\n            int bit = x>>i&1;\n            if(!(root->next[bit])){\n                root->next[bit] = new node();\n            }\n            root = root->next[bit];\n            root->cnt++;\n        }\n    }\n    // removes count occurence of the number from the trie\n    void remove(int x,int count = 1){\n        node* root = R;\n        for(int i = MAX_BIT;i>=0;i--){\n            int bit = ((1<<i)&x)>=1;\n            assert(root->next[bit]);\n            node* next = root->next[bit];\n            if(next->cnt == count){\n                root->next[bit] = NULL;\n                break;\n            }else{\n                root = next;\n                root->cnt -= count;\n            }\n        }\n    }\n    int get(int x){\n        node* root = R;\n        int ans = 0;\n        for(int i = MAX_BIT;i>=0;i--){\n            int bit = ((1<<i)&x)>=1;\n            if(!root->next[bit^1]){\n                if(!root->next[bit]){\n                    return ans;\n                }else{\n                    root = root->next[bit];\n                }\n            }else{\n                ans += (1<<i);\n                root = root->next[bit ^ 1];\n            }\n        }\n        return ans;\n    }\n};\n\nclass Solution {\npublic:\n    vector<vector<int>> G;\n    vector<vector<pair<int,int>>> Q;\n    vector<int> ans;\n   \n    XOR_binary_trie *trie;\n    void dfs(int s,int par){\n        //add \n        trie->add(s);\n        for(auto [val,idx] : Q[s]){\n            int mx = trie->get(val);\n            ans[idx] = mx;\n        }\n        for(int c : G[s]){\n            if(c == par) continue;\n            dfs(c,s);\n        }\n        \n        //remove\n        trie->remove(s);\n        \n    }\n    vector<int> maxGeneticDifference(vector<int>& parents, vector<vector<int>>& queries) {\n        ios_base::sync_with_stdio(false);\n        int n = parents.size();\n        // make tree\n        G.resize(n+1);\n        Q.resize(n+1);\n        int rooto = -1;\n        for(int i =0 ;i < n;i++){\n            if(parents[i] == -1) {\n                rooto = i;\n                continue;\n            }\n            G[i].push_back(parents[i]);\n            G[parents[i]].push_back(i);\n        }\n        \n        trie = new XOR_binary_trie();\n        int q = queries.size();\n        ans.resize(q);\n        \n        int pos = 0;\n        for(auto query : queries){\n            int node = query[0];\n            int val = query[1];\n            Q[node].emplace_back(val,pos++);\n        }\n        \n        dfs(rooto,rooto);\n    \n        \n        return ans;\n    }\n};","compare_result":"1111111111111111111111111111111111111111111111111111111111","title_slug":"maximum-genetic-difference-query"}