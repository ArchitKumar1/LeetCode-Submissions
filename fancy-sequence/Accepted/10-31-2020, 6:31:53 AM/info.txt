{"id":415063399,"lang":"cpp","time":"1 year, 1 month","timestamp":1604106113,"status_display":"Accepted","runtime":"764 ms","url":"/submissions/detail/415063399/","is_pending":"Not Pending","title":"Fancy Sequence","memory":"190.5 MB","code":"class Fancy {\n    private:\n    const int mod = 1e9+7;\n    #define LL long long int\n    \npublic:\n    \n    int pow_mod(LL a,LL b){\n        if(b == 0) return 1;\n        LL res = 1;\n        if(b%2 == 1){\n            res *= a;\n            res %= mod;\n        }\n        res *= pow_mod(a*a%mod,b/2);\n        res %= mod;\n        return res;\n    }\n    \n    vector<LL> vals = {0};\n    vector<pair<LL,LL>> mas = {{1,0}};\n    \n    Fancy() {\n        \n    }\n    \n    void append(int val) {\n        vals.push_back(val);\n        mas.push_back(mas.back());\n    }\n    \n    void addAll(int inc) {\n       (mas.back().second += inc)%=mod;\n    \n    }\n    \n    void multAll(int m) {\n        (mas.back().first *= m)%=mod;\n        (mas.back().second *= m)%=mod;\n    }\n    \n    int getIndex(int idx) {\n        int n = vals.size();\n        if(idx >= vals.size()-1 || vals.size() == 1) {\n            return -1;\n        }\n\n        int mul = mas.back().first*pow_mod(mas[idx].first,mod-2) %mod;\n        int sum = (mod + mas.back().second - mas[idx].second*mul%mod)%mod;\n        \n        return (vals[idx+1]*mul%mod + sum)%mod;\n    }\n};\n\n/**\n * Your Fancy object will be instantiated and called as such:\n * Fancy* obj = new Fancy();\n * obj->append(val);\n * obj->addAll(inc);\n * obj->multAll(m);\n * int param_4 = obj->getIndex(idx);\n */","compare_result":"11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111","title_slug":"fancy-sequence"}